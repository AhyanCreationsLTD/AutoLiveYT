name: The Challengers Stealth Streamer
on:
  repository_dispatch:
    types: [start_stream]

jobs:
  stream:
    runs-on: ubuntu-latest
    steps:
      - name: Install Professional Tools
        run: sudo apt update && sudo apt install -y ffmpeg curl jq

      - name: Execute Stealth Broadcast
        run: |
          # ‡¶≤‡¶ø‡¶ô‡ßç‡¶ï ‡¶°‡¶ø‡¶ï‡ßã‡¶°
          VIDEO_URL=$(echo "${{ github.event.client_payload.secure_id }}" | base64 --decode)
          
          echo "üöÄ Processing Stream for The Challengers..."

          # FFmpeg Engine: ‡¶≤‡ßã‡¶ó‡ßã ‡¶Ø‡ßã‡¶ó ‡¶ï‡¶∞‡¶æ ‡¶è‡¶¨‡¶Ç ‡¶ï‡¶™‡¶ø‡¶∞‡¶æ‡¶á‡¶ü ‡¶¨‡¶æ‡¶á‡¶™‡¶æ‡¶∏ ‡¶ï‡¶∞‡¶æ
          # ‡ßß. ‡¶ï‡¶æ‡¶≤‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶Æ‡¶æ‡¶®‡ßç‡¶Ø ‡¶∂‡¶æ‡¶∞‡ßç‡¶™ ‡¶ï‡¶∞‡¶æ (‡¶Æ‡¶æ‡¶®‡ßÅ‡¶∑‡ßá‡¶∞ ‡¶ö‡ßã‡¶ñ‡ßá ‡¶≠‡¶æ‡¶≤‡ßã ‡¶≤‡¶æ‡¶ó‡¶¨‡ßá, ‡¶¨‡¶ü‡ßá‡¶∞ ‡¶ï‡¶æ‡¶õ‡ßá ‡¶®‡¶§‡ßÅ‡¶® ‡¶´‡¶æ‡¶á‡¶≤)
          # ‡ß®. ‡¶≤‡ßã‡¶ó‡ßã "The Challengers" ‡¶¨‡¶æ‡¶Æ ‡¶™‡¶æ‡¶∂‡ßá‡¶∞ ‡¶â‡¶™‡¶∞‡ßá ‡¶Ö‡ßç‡¶Ø‡¶æ‡¶° ‡¶ï‡¶∞‡¶æ
          # ‡ß©. ‡¶Ö‡¶°‡¶ø‡¶ì ‡¶™‡¶ø‡¶ö ‡ßß% ‡¶™‡¶∞‡¶ø‡¶¨‡¶∞‡ßç‡¶§‡¶® ‡¶ï‡¶∞‡¶æ (‡¶¨‡¶ü ‡¶Æ‡¶ø‡¶â‡¶ú‡¶ø‡¶ï ‡¶ö‡¶ø‡¶®‡¶§‡ßá ‡¶™‡¶æ‡¶∞‡¶¨‡ßá ‡¶®‡¶æ)

          ffmpeg -re -stream_loop -1 -i "$VIDEO_URL" \
            -vf "scale=1280:720,setpts=0.99*PTS,hue=s=1.1:b=0.05,unsharp=3:3:1.5,drawtext=text='THE CHALLENGERS':x=30:y=30:fontsize=24:fontcolor=white@0.5:box=1:boxcolor=black@0.3:boxborderw=5" \
            -af "atempo=1.01,volume=1.2,highpass=f=50,lowpass=f=15000" \
            -c:v libx264 -preset ultrafast -tune zerolatency -b:v 3000k -maxrate 3500k -bufsize 7000k \
            -pix_fmt yuv420p -r 30 -g 60 -map_metadata -1 \
            -c:a aac -b:a 128k -ar 44100 \
            -f flv "rtmp://a.rtmp.youtube.com/live2/${{ secrets.YOUTUBE_STREAM_KEY }}"
            
